function initControls(){stage.addEventListener("stagemousedown",onMouseDown),stage.addEventListener("stagemouseup",onMouseUp),stage.addEventListener("stagemousemove",onMouseMove)}function onMouseDown(n){currentPoint=map.globalToLocal(n.stageX,n.stageY),currentCoord=pointToCoord(currentPoint),currentTile=getTile(currentCoord.q,currentCoord.r),0===n.nativeEvent.button&&(drawing=!0,connectionPath=[JSON.stringify(currentCoord)],console.log(pointToCoord(currentPoint))),2===n.nativeEvent.button&&(dragging=!0,dragOrigin={x:n.stageX-map.x*cam.scaleX,y:n.stageY-map.y*cam.scaleY})}function onMouseMove(n){currentPoint=map.globalToLocal(n.stageX,n.stageY),currentCoord=pointToCoord(currentPoint),currentTile=getTile(currentCoord.q,currentCoord.r),drawing&&(_.contains(connectionPath,JSON.stringify(currentCoord))||connectionPath.push(JSON.stringify(currentCoord))),dragging&&(map.x=(n.stageX-dragOrigin.x)/cam.scaleX,map.y=(n.stageY-dragOrigin.y)/cam.scaleY),JSON.stringify(prevCoord)!=JSON.stringify(currentCoord)&&(map.removeChild(pointerTile),currentTile||new PointerTile(currentCoord.q,currentCoord.r)),prevCoord=currentCoord}function onMouseUp(n){0===n.nativeEvent.button&&(drawing=!1,connectionPath=_.map(connectionPath,function(n){return JSON.parse(n)}),console.log(JSON.stringify(connectionPath))),2===n.nativeEvent.button&&(dragging=!1)}var drawing=dragging=!1,dragOrigin,currentTile,currentPoint,currentCoord,prevCoord,connectionPath,pointerTile;